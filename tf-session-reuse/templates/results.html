<!doctype html>
<html lang='en'>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Suggestions for your image</title>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

</head>
<body>

Your image:
<img src={{ image_path }} height='200' />
<br />

<div id="media-group">
  {% for prediction in preds|dictsort(by='value')|reverse  %}
    <div id={{prediction[0]}} class="media"></div>
  {% endfor %}
</div>

<!-- Latest compiled and minified JavaScript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script>
$(document).ready(function(){
  predictions = {{ preds }}
  var sorted = [];
  for(var key in predictions) {
    sorted[sorted.length] = key;
  }
  sorted.sort();

  taxa = Object.keys(predictions);
  url = "http://api.inaturalist.org/v1/taxa/"+sorted;
  $.get(url, function(data, status) {
    for (iter in data['results']) {
      taxon = data['results'][iter]
      console.log(taxon);
      photo_url = taxon['default_photo']['square_url'];
      taxon_id = taxon['id'];
      prediction = predictions[taxon_id];
      scientific_name = taxon['name']
      common_name = taxon['preferred_common_name']
      console.log(taxon_id + ': ' + photo_url);
      list = document.getElementById("results")
      $("#"+taxon_id).append($("<div class='media-left'><a href='#'><img class='media-object' src='"+photo_url+"'></a></div><div class='media-body'><h4 class='media-heading'>"+prediction+"</h4>"+common_name+"<br/><em>"+scientific_name+"</em></div>"));
    }
  });
});
</script>
</body>
</html>
